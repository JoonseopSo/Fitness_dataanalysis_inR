---
title: "Fit-Data-Analysis"
author: "Joonseop So"
date: "2023-09-15"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Fitness Data Analysis in .rmd

A dataset was provided with health and fitness data from over 25 individuals. This is a analysis on trends and future take for business owners to improve sales or better marketing. 

But first, we need to read and install all the packages and libraries and csv files. 
packages to be installed: 

install.packages("dplyr")
install.packages("corrplot")
install.packages("gghighlight")
install.packages("tidyverse")

```{r load packages and data, message=FALSE, warning=FALSE}
library(dplyr)
library(readr)
library(tidyverse)
library(lubridate)
library(ggplot2)
library(corrplot)
library(gghighlight)
sleepDay_merged <- read_csv("CaseStudy Datas/Fitabase Data 4.12.16-5.12.16/sleepDay_merged.csv")
sleepDay_merged <- sleepDay_merged %>% rename(ActivityDay = SleepDay)
weightLogInfo_merged <- read_csv("CaseStudy Datas/Fitabase Data 4.12.16-5.12.16/weightLogInfo_merged.csv")
dailyActivity_merged <- read_csv("CaseStudy Datas/Fitabase Data 4.12.16-5.12.16/dailyActivity_merged.csv")
dailyActivity_merged <- dailyActivity_merged %>% rename(ActivityDay = ActivityDate)
dailyCalories_merged <- read_csv("CaseStudy Datas/Fitabase Data 4.12.16-5.12.16/dailyCalories_merged.csv")
dailyIntensities_merged <- read_csv("CaseStudy Datas/Fitabase Data 4.12.16-5.12.16/dailyIntensities_merged.csv")
```

### Note

I also changed the name of some columns to make merging every dataset into 1 dataframe easier.

## Merging the dataframe and adding weekdays

```{r Merging and add Columns, message=FALSE, warning=FALSE}
day_data <- merge(x=dailyActivity_merged, y=dailyIntensities_merged,  by.x = c("ActivityDay","Id"),by.y = c("ActivityDay", "Id"))
day_data$ActivityDay <- as.Date(day_data$ActivityDay, format = "%m/%d/%Y")
sleepDay_merged$ActivityDay <- as.Date(sleepDay_merged$ActivityDay, format = "%m/%d/%Y %H:%M:%S AM")
day_data_sleep <- merge(x=day_data, y=sleepDay_merged,  by.x = c("ActivityDay","Id"),by.y = c("ActivityDay", "Id"))
day_data_sleep$weekday <- wday(day_data_sleep$ActivityDay)
day_data_sleep$weekday <- recode(day_data_sleep$weekday, 
                        "1"="Sunday",
                        "2"="Monday",
                        "3"="Tuesday",
                        "4"="Wednesday",
                        "5"="Thursday",
                        "6"="Friday",
                        "7"="Saturday")
day_data$weekday <- wday(day_data$ActivityDay)
day_data$weekday <- recode(day_data$weekday, 
                        "1"="Sunday",
                        "2"="Monday",
                        "3"="Tuesday",
                        "4"="Wednesday",
                        "5"="Thursday",
                        "6"="Friday",
                        "7"="Saturday")
head(day_data)
```
## Clean the data for missing values and errors

```{r}
day_data <- Filter(Negate(is.null), day_data)
day_data_sleep <- Filter(Negate(is.null), day_data_sleep)
```




## First analysis with correlation matrix
```{r}
data_cor <- subset(day_data_sleep, select = -c(ActivityDay, Id, weekday))
cor <- cor(data_cor)
corrplot(cor, type = "upper", order = "hclust", 
         tl.col = "black", tl.srt = 45)
```

### Note

The matrix shows overall negative correlation of sleep with any kind of activity. 
Also higher correlation of Steps and Distance to Â´very activ activity.

## Plotting of different kind of activity dependent on weekday

```{r}
ggplot(day_data , aes(x=ActivityDay, y=LightlyActiveMinutes.y , color = factor(weekday)))+ geom_line(aes(group = weekday), size =0.5)+facet_wrap(~Id)
ggplot(day_data , aes(x=ActivityDay, y=LightlyActiveMinutes.y , fill = factor(weekday)))+ geom_col(aes(group = weekday), size =0.5)+facet_wrap(~Id)
```

### Note

As we can see some plots are missing or are incomplete. Thats an indicator for not doing the exercise or error. The uncompleted plots are results of discontinuing the exercise. <br>
I will remove the incomplete plots for better analysis

```{r}
day_data<- filter(day_data, Id !="4057192912"& Id!="2347167796"& Id!="3372868164"& Id!="8253242879")

ggplot(day_data , aes(x=ActivityDay, y=LightlyActiveMinutes.y , color = factor(weekday)))+ geom_line(aes(group = weekday), size =0.5)+facet_wrap(~Id)
```

#### What trends are visible?
 To see some trends lets compare the plots of each different kind of activity.
```{r}
ggplot(day_data , aes(x=ActivityDay, y=SedentaryMinutes.y , color = factor(weekday)))+ geom_line(aes(group = weekday), size =0.5)+facet_wrap(~Id)+ggtitle("Sedentary")
ggplot(day_data , aes(x=ActivityDay, y=LightlyActiveMinutes.y , color = factor(weekday)))+ geom_line(aes(group = weekday), size =0.5)+facet_wrap(~Id)+ggtitle("Lightly Active")
ggplot(day_data , aes(x=ActivityDay, y=FairlyActiveMinutes.y , color = factor(weekday)))+ geom_line(aes(group = weekday), size =0.5)+facet_wrap(~Id)+ggtitle("Fairly Active")
ggplot(day_data , aes(x=ActivityDay, y=VeryActiveMinutes.y , color = factor(weekday)))+ geom_line(aes(group = weekday), size =0.5)+facet_wrap(~Id)+ggtitle("Very Active")
ggplot(day_data_sleep , aes(x=ActivityDay, y=TotalMinutesAsleep , fill = factor(Id)))+ geom_col(aes(group = Id), size =1)+facet_wrap(~Id)+ggtitle("Sleeping hours")
```
<br>
In every plot we see different type of people and their activity behavior. If every line in a plot is close to each other and shows a similar trend (straight line horizontally), this means that this individual has regular workouts or activities. <br>
High fluctuations means spontaneous activities. <br>
If a specific color is abnormally high: This individual has a certain day to train or do exercise. <br>
The first plot shows the sedentary time an individual has at the same day. Due to negative correlation shown in the matrix before the plots also shows a horizontal mirroring to the second plot which indicates the lightly active minutes of an individual. <br>
<br>
Overall the trend shows that higher intensity training is less popular and through out the time-interval people tend to train less than the beginning. We see an overall downtrend due to lack of perseverance
<br>
<br>
Especially Thursdays seems to be the day where most people don't exercise intensely while Wednesday is the day where mos people don't exercise lightly.
```{r warning=FALSE}
df1<- day_data %>%
  group_by(weekday) %>%
  summarise_at(vars(LightlyActiveMinutes.y,FairlyActiveMinutes.y, VeryActiveMinutes.y), list(name = mean))
df1
ggplot(day_data , aes(x=ActivityDay, y=LightlyActiveMinutes.y , color = factor(weekday)))+ geom_line(aes(group = weekday), size =0.5)+facet_wrap(~Id)+gghighlight(weekday=="Wednesday")+ggtitle("Lightly Active, Highlight Wednesday")
ggplot(day_data , aes(x=ActivityDay, y=VeryActiveMinutes.y , color = factor(weekday)))+ geom_line(aes(group = weekday), size =0.5)+facet_wrap(~Id)+gghighlight(weekday=="Thursday")+ggtitle("Very Active, Highlight Thursday")
ggplot(day_data , aes(x=ActivityDay, y=FairlyActiveMinutes.y , color = factor(weekday)))+ geom_line(aes(group = weekday), size =0.5)+facet_wrap(~Id)+gghighlight(weekday=="Thursday")+ggtitle("Fairly Active, Highlight Thursday")
```

## Takeaway

The key takeaway from this analysis is that people do buy fitness gadgets not to track their accomplishments but rather for different reasons. As shown in the plots only a fraction of people are using this device for high intensity active training.<br>
The majority are using this for fashionable or other reasons. <br>
If this company want to target high active customers, then there need to be a new approach on marketing this device. Or the integration of an reward system for very active Users. If the company want to target the general public, then new accessorizes such as new wrist bands or customizable device UIs should attract new Users. 